> [[大话设计模式.pdf#page=446&selection=9,0,13,1|访问者模式]]
## 核心思想

> 表示一个作用于某对象结构中的各元素的 操作。它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作

- 抽象访问者（Visitor）：定义了对每个元素类型访问的行为，它的方法个数与元素类型的个数相同。
- 具体访问者（ConcreteVisitor）：实现抽象访问者角色中定义的操作。
- 抽象元素（Element）：定义了一个接受访问者对象的方法（通常为 `accept`），这个方法通常以访问者作为参数。
- 具体元素（ConcreteElement）：实现了抽象元素角色，实现了 `accept` 方法，在 `accept` 方法中调用访问者的访问方法。
- 对象结构（Object Structure）：通常是一个包含多个不同类型元素的集合，它能够迭代这些元素，使访问者能够访问到每一个元素。
## 优势

1. 增加新的操作容易：访问者模式允许在不改变元素类的前提下增加新的操作，只需增加一个新的具体访问者类即可。
2. 访问者对象和元素对象分离：访问者对象和元素对象分离，使得操作集合可以独立变化，提高了系统的可扩展性和灵活性。
3. 符合单一职责原则：每个具体访问者类只专注于一种操作，使得类的职责更加清晰。
## 缺陷

1. 增加新的元素类困难：访问者模式要求访问者类能够处理对象结构中的所有元素类，因此增加新的元素类需要修改抽象访问者及其所有具体访问者类，这违反了开闭原则。
2. 访问者模式使得元素类层次变得复杂：元素类需要有一个 `accept` 方法，以及能够被访问者访问的内部状态，这可能会使得元素类的接口变得复杂。
3. 破坏封装：访问者模式要求元素类必须暴露一些内部状态给访问者，这可能会破坏元素的封装性。
## UML

![[访问者模式.png]]
## 场景

> 访问者模式的目的是要把处理从数据结构分离出来。很多系统可以按 照算法和数据结构分开，如果这样的系统有比较稳定的数据结构，又有易于 变化的算法的话，使用访问者模式就是比较合适的，因为访问者模式使得算 法操作的增加变得容易